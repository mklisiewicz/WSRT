#include "config.h"
#include "i2c.h"
#include <linux/i2c-dev.h>
#include <sys/ioctl.h>
#include <unistd.h>

const uint8_t USB_SET[]{
    0xB5, 0x62, 0x06, 0x8A, 0x18, 0x00,
    0x00, 0x01, 0x00, 0x00, 0x01, 0x00,
    0x78, 0x10, 0x01, 0x01, 0x00, 0x78,
    0x10, 0x01, 0x02, 0x00, 0x78, 0x10,
    0x01, 0x01, 0x00, 0x77, 0x10, 0x01, 
    0xD1, 0x28, 0x00, 0x00
};

const uint8_t DISABLE_UART1[] = {
    0xB5, 0x62, 0x06, 0x00, 0x14, 0x00,
    0x01, 0x00, 0x00, 0x00, 0xD0, 0x08,
    0x00, 0x00, 0x00, 0x96, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x89, 0x46};

const uint8_t DISABLE_UART2[] = {
    0xB5, 0x62, 0x06, 0x00, 0x14, 0x00, 
    0x02, 0x00, 0x00, 0x00, 0xD0, 0x08, 
    0x00, 0x00, 0x00, 0x96, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x8A, 0x5A};

const uint8_t DISABLE_USB[] = {
    0xB5, 0x62, 0x06, 0x00, 0x14, 0x00,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x1D, 0x84};

const uint8_t DISABLE_SPI[] = {
    0xB5, 0x62, 0x06, 0x00, 0x14, 0x00, 
    0x04, 0x00, 0x00, 0x00, 0x00, 0x32, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x50, 0x86};

const uint8_t SET_RATE_UTC[] = {
    0xB5, 0x62, 0x06, 0x08, 0x06, 0x00,
    0x19, 0x00, 0x01, 0x00, 0x00, 0x00,
    0x2E, 0x4E
};

const uint8_t SET_RATE_GPS[] = {
    0xB5, 0x62, 0x06, 0x08, 0x06, 0x00,
    0x19, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x2F, 0x50
};

const uint8_t SET_RATE_GAL[] = {
    0xB5, 0x62, 0x06, 0x08, 0x06, 0x00, 
    0x19, 0x00, 0x01, 0x00, 0x02, 0x00, 
    0x30, 0x52
};

const uint8_t SET_RATE_GLO[] = {
    0xB5, 0x62, 0x06, 0x08, 0x06, 0x00, 
    0x19, 0x00, 0x01, 0x00, 0x03, 0x00, 
    0x31, 0x54
};

const uint8_t SET_RATE_BDS[] = {
    0xB5, 0x62, 0x06, 0x08, 0x06, 0x00, 
    0x19, 0x00, 0x01, 0x00, 0x04, 0x00, 
    0x32, 0x56,
};

const uint8_t SET_NMEA[] = {
    0xB5, 0x62, 0x06, 0x8A, 0x0E, 0x00,
    0x00, 0x01, 0x00, 0x00, 0xAB, 0x00, 
    0x91, 0x20, 0x01, 0xB5, 0x00, 0x91, 
    0x20, 0x01, 0x63, 0x1C
};

const uint8_t* commands[] = {
    DISABLE_UART1,
    DISABLE_UART2,
    //DISABLE_USB,
    DISABLE_SPI,
    SET_RATE_UTC,
    SET_RATE_GPS,
    SET_RATE_GAL,
    SET_RATE_GLO,
    SET_RATE_BDS,
    USB_SET
};

void sendConfig(int i2cHandle) {
    for (int i = 0; i < sizeof(commands); i++){
        write(i2cHandle, commands[i], sizeof(commands));
    }
}
